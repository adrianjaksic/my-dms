(function(n,t,i){function it(){var n=t(this),r=n.parent(),i;n.hasClass("tabSel")||(r.find("li.tabSel").removeClass("tabSel"),n.addClass("tabSel"),t(".tabSekcije").hide(),i=n.attr("data-tab"),t(i).show())}function rt(){var n=t("#masterSifSectionWrap"),i;n.find(".tabSekcije").hide();i=t("#masterSifTabovi").find("li.tabSel").attr("data-tab");n.find(i).show()}function ut(){var n;u=i;var r=t("#kriterijum1"),e=t("#kriterijum2"),o=t("#kriterijum3");if(r.length>0&&r.quiComboBox("getSelectedItemData")==i||e.length>0&&e.quiComboBox("getSelectedItemData")==i||o.length>0&&o.quiComboBox("getSelectedItemData")==i){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),qKonverzija.VratiLokalizovaniTekst("Kriterijum nije selektovan."),"greska");return}(t("#masterSifTaboviIBtnWrap").hide(),t("#masterSifSectionWrap").html(""),t("#masterSifTree").html(""),n=t("#masterSifBtnPretrazi").find("table"),n.hasClass("teloDugmeIskljuceno"))||(n.addClass("teloDugmeIskljuceno"),t.ajax({type:"GET",url:s,data:{tipDokumenta:f,kriterijum1:r.quiComboBox("getSelectedItemData"),kriterijum2:e.quiComboBox("getSelectedItemData"),kriterijum3:o.quiComboBox("getSelectedItemData")},success:function(n){if(n.Greska){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),n.Poruka,"greska");return}g(n.Data);nt(!0);t("#masterSifStabloWrap").show();t("#masterSifTree").show()},complete:function(){n.removeClass("teloDugmeIskljuceno")}}))}function ft(){t("#kriterijum1").quiComboBox("clearSelectionNoTrigger");t("#kriterijum2").quiComboBox("clearSelectionNoTrigger");t("#kriterijum3").quiComboBox("clearSelectionNoTrigger");t("#masterSifTaboviIBtnWrap").hide();t("#masterSifTabovi").html("");t("#masterSifSectionWrap").html("");t("#masterSifStabloWrap").hide()}function b(n){return n.replace(/ /g,"_")}function k(n){var e,c=i,s="",h=t("#masterSifBtnSacuvaj").find("table");if(n){if(u!==i&&t("#masterSifTree").find(".sel").click(),e=t("#masterSifBtnDodajNoviNode").find("table"),e.hasClass("teloDugmeIskljuceno"))return;h.hasClass("noviNode")||h.addClass("noviNode");s="Unos novog"}else{if(u===i){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),qKonverzija.VratiLokalizovaniTekst("Nije odabrana stavka za izmenu."),"greska");return}if(c=u.IdElementa,e=t("#masterSifBtnIzmeniNode").find("table"),e.hasClass("teloDugmeIskljuceno"))return;h.hasClass("noviNode")&&h.removeClass("noviNode");s=u.Naziv}r.DodavanjeIdeNaRoot&&(idNadredjenogElementa=i);e.addClass("teloDugmeIskljuceno");t("#masterSifTabovi").html("");t("#masterSifSectionWrap").html("");t("#masterSifTaboviIBtnWrap").hide();t.ajax({type:"GET",url:o,data:{tipDokumenta:f,idElementa:c,kriterijum1:t("#kriterijum1").quiComboBox("getSelectedItemData"),kriterijum2:t("#kriterijum2").quiComboBox("getSelectedItemData"),kriterijum3:t("#kriterijum3").quiComboBox("getSelectedItemData")},success:function(n){var u,o,r,f,h,c,e,l;if(n.Greska){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),n.Poruka,"greska");!t(".masterSifTree").length>0&&t("#masterSifStabloWrap").find("#masterSifStabloNaslov h3").html("");return}if(u=n.Data,u&&u.length>0){for(o=0;o<u.length;++o)if(r=u[o],r.NazivGrupe!=i){if(f=b(r.NazivGrupe),t.inArray(f,w)==-1?(w.push(f),d(r.NazivGrupe,s)):t("#masterSifTabovi").has('li[data-tab="#'+f+'"]').length==0&&d(r.NazivGrupe,s),r.TipPodatka==70){for(h=[],c=0;c<u.length;++c)e=u[c],e.Id!=r.Id&&e.IdNadredjenogElementa!=i&&e.IdNadredjenogElementa==r.Id&&h.push(e);h.length>0&&(r.Podredjeni=h)}st(r,f)}rt();t("#masterSifTaboviIBtnWrap").show();t("#masterSifStabloWrap").show();t("#masterSifSectionWrap").find("section .hederH1").remove();t("#masterSifSectionWrap").find("section").each(function(){var n=t(this),i=n.find("#masterSifSectionContentPoljaLevo"),r=n.find("#masterSifSectionContentPoljaDesno");i.children().length==0&&r.children().length==0&&(i.remove(),r.remove())});t("#masterSifTabovi").find("li").length>0?t("#masterSifTaboviWrap").show():t("#masterSifTaboviWrap").hide();l=t("#masterSifSectionWrap");l.is(":hidden")&&l.show();t(".masterSifTree").length==0&&t("#masterSifSectionWrap").find("section .hederH1").remove()}else t("#masterSifTaboviIBtnWrap").hide(),t("#masterSifTaboviWrap").hide()},complete:function(){e!=i&&(e.removeClass("teloDugmeIskljuceno"),e.hasClass("noviNode")&&e.removeClass("noviNode"))}})}function et(){if(u===i){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),qKonverzija.VratiLokalizovaniTekst("Nije odabrana stavka za brisanje."),"greska");return}var n=t("#masterSifBtnObrisiNode").find("table");n.hasClass("teloDugmeIskljuceno")||(n.addClass("teloDugmeIskljuceno"),t.ajax({type:"POST",url:c,data:{tipDokumenta:f,idElementa:u.IdElementa},success:function(n){var r,f,e;if(n.Greska){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),n.Poruka,"greska");return}u=i;r=t("#masterSifTree");n.Data?r.quiTree("removeSelectedItem"):r.find(".sel").removeClass("sel");f=t("#masterSifTaboviIBtnWrap");e=t("#masterSifSectionWrap");f.is(":visible")&&f.hide();e.is(":visible")&&e.hide()},complete:function(){n.removeClass("teloDugmeIskljuceno")}}))}function ot(){var e,n,o;if(log(u),e=i,n=t("#masterSifBtnSacuvaj").find("table"),!n.hasClass("teloDugmeIskljuceno")){if(!n.hasClass("noviNode"))if(t(".masterSifTree").length>0){if(u===i){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),qKonverzija.VratiLokalizovaniTekst("Nije odabrana stavka za unos ili izmenu."),"greska");return}e=u.IdElementa}else e=t("#masterSifPretragaInput").val().trimnull();o=ht();n.addClass("teloDugmeIskljuceno");t.ajax({type:"POST",url:h,data:{tipDokumenta:f,idElementa:e,podaciJ:JSON.stringify(o)},success:function(u){var f,e,o;if(u.Greska){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),u.Poruka,"greska");return}f=u.Data;e=t("#masterSifTree");f&&(n.hasClass("noviNode")?r.DodavanjeIdeNaRoot?(e.quiTree("addItem",f,1),t("#masterSifBtnDodajNoviNode").click()):f.IdNadredjenogElementa!=i?e.quiTree("addItem",f,2):e.quiTree("addItem",f,1):(e.quiTree("updateSelectedItem",f),o=e.find(".sel"),o.addClass("new"),setTimeout(function(){o.removeClass("new")},1e3)))},complete:function(){n.removeClass("teloDugmeIskljuceno")}})}}function d(n,i){var r=b(n),f=t("#masterSifTabovi"),u;f.find("li").length>0?t("#masterSifTabovi").append('<li class="tab" data-tab="#'+r+'"><span class="tabText">'+n+"<\/span><\/li>"):t("#masterSifTabovi").append('<li class="tab tabSel" data-tab="#'+r+'"><span class="tabText">'+n+"<\/span><\/li>");u='<section id="'+r+'" class="tabSekcije" style="width: 60%; float: right; min-height:360px;"><div class="hederH1" style="margin-bottom: 0px;"><h2>'+i+'<\/h2><\/div><div id="masterSifSectionContentPolja" style="height: 40%; width: 100%;"><div class="unosRed" id="masterSifSectionContentPoljaLevo" style="width: 45%; float: left; margin-top: 5px; height: auto;"><\/div><div class="unosRed" id="masterSifSectionContentPoljaDesno" style="width:45%; float: right; margin-top: 5px; height: auto;"><\/div><div class="unosRed" id="masterSifSectionContentPoljaDole" style="width:100%; float: right;"><\/div><\/div><div class="clear"><\/div>';u+="<\/section>";t("#masterSifSectionWrap").append(u)}function st(n,r){var o,et,ti,ot,tt,ut,ii,ri,h,a,g,b,ui,fi,nt,ei,dt,oi,v;if(n.IdNadredjenogElementa==i){var u="",k="min-width:35%; max-width: 35%",gt="min-width:65%; max-width: 75%; margin-right: 15%",d="62%",it="100%",ni=t("#masterSifSectionWrap").find("#"+r),rt=ni.find("#masterSifSectionContentPolja"),y=rt.find("#masterSifSectionContentPoljaLevo"),c=rt.find("#masterSifSectionContentPoljaDesno"),p=rt.find("#masterSifSectionContentPoljaDole"),f="",ft=rt.find(".masterSifPoljeUSection").length,s="margin-left: 1%;",e="margin-bottom: 5px;",l=!0;l=ft%2==0?!0:!1;++ft;o="";n.Vrednost!=i&&(o=n.Vrednost);f="masterSifSection"+r+"Podatak"+ft;switch(n.TipPodatka){case 0:u+='<div style="display:none;" class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+k+"; "+s+e+'">'+n.Naziv+':<\/div>                            <div class="unosRedVr" style="'+e+"; width:"+d+'">                                <input type="text" id="'+f+'" class="myInput" disabled="disabled" value="'+o+'" data-val="'+o+'" style="width:'+it+';" />                            <\/div>                        <\/div>';l?y.append(u):c.append(u);break;case 2:case 11:et=n.PotrebniPodaci!=i?n.PotrebniPodaci:"";u+='<div class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+k+"; "+s+e+'">'+n.Naziv+':<\/div>                            <div class="unosRedVr" style="'+e+"; width:"+d+'">                                <input type="text" id="'+f+'" class="myInput" value="'+o+'" data-val="'+o+'" style="width:'+it+';" />                            <\/div>';et.length>0&&(u+='<div class="unosRedLbl_taL" style="width: 100%; font-size: 9px;'+s+e+'">'+et+"<\/div>");u+="<\/div>";l?y.append(u):c.append(u);break;case 111:u+='<div class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+k+"; "+s+e+'">'+n.Naziv+':<\/div>                            <div class="unosRedVr" style="'+e+"; width:"+d+'">                                <input type="text" id="'+f+'" class="myInput" disabled="disabled" value="'+o+'" data-val="'+o+'" style="width:'+it+';" />                            <\/div>                        <\/div>';l?y.append(u):c.append(u);break;case 112:u+='<div class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+k+"; "+s+e+'">'+n.Naziv+':<\/div>                            <div class="unosRedVr" style="'+e+"; width:"+d+'">                                <textarea class="myInputTAFix" style="width:'+it+';" value="'+o+'" data-val="'+o+'" id="'+f+'">'+o+'<\/textarea>                            <\/div>                        <\/div><div class="clear"><\/div>';l?y.append(u):c.append(u);break;case 13:ti=n.Vrednost.toLowerCase()=="true"?"checked='checked'":"";u+='<div class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+gt+"; "+s+e+'">'+n.Naziv+':<\/div>                            <div class="unosRedVr" style="float: right;">                                <input type="checkbox" id="'+f+'" style="'+e+'" '+ti+"><\/div>                            <\/div>                        <\/div>";l?y.append(u):c.append(u);break;case 20:u+='<div class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'" data-idZavisnogElementa="'+nonull(n.IdZavisnogElementa)+'">                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+k+"; "+s+e+'">'+n.Naziv+':<\/div>                            <div class="unosRedVr" style="'+e+" width:"+d+';"><div id="'+f+'" style="width: 100%;"><\/div>                            <\/div>                        <\/div>';l?y.append(u):c.append(u);break;case 21:ot="";n.PotrebniPodaci!=i&&(ot='data-potrebniPodaci="'+n.PotrebniPodaci+'"');u+='<div class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'" '+ot+'>                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+k+"; "+s+e+'">'+n.Naziv+':<\/div>                            <div class="unosRedVr" style="'+e+" width:"+d+';"><div id="'+f+'" style="width: 100%;"><\/div>                            <\/div>                        <\/div>';l?y.append(u):c.append(u);break;case 70:if(n.Podredjeni!=i&&n.Podredjeni.length>0){for(tt=0;tt<n.Podredjeni.length;++tt){var w=n.Podredjeni[tt],st=f+"Podredjeni"+tt,si='<div class="masterSifPoljeUSection podredjeni" data-id="'+w.Id+'" data-fullId="'+st+'" data-idNadredjenog="'+n.Id+'">                                                <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; width: 100px; '+s+e+'">'+w.Naziv+':<\/div>                                                <div class="unosRedVr" style="'+e+';"><div id="'+st+'" style="width: 100%;"><\/div>                                                <\/div>                                            <\/div>',ht=t(si);if(ht.data("data-podatak",w),p.append(ht),ut=ht.find("#"+st),ut.quiComboBox({listWidth:280,width:180,showX:!0}),w.IzborniPodaci!=i&&w.IzborniPodaci.length>0&&ut.quiComboBox("setItemsFromBinding",w.IzborniPodaci,"Naziv","IdPodatka"),w.ImaZavisneElemente)ut.on("select",function(){ct(t(this))})}p.append('<div class="teloDugmeWrapUFormi btnW3 btnFloatR" data-id="'+n.Id+'" id="'+f+'btnDodajNoviRedTabele">                                                        <table class="teloDugme">                                                            <tbody><tr>                                                                <td>'+qKonverzija.VratiLokalizovaniTekst("Dodaj novi red")+'<\/td>                                                            <\/tr>                                                        <\/tbody><\/table>                                                    <\/div><div class="clear"><\/div>');ii=p.find("#"+f+"btnDodajNoviRedTabele");ii.on("click",function(){var o=t(this),s=o.parent(),h=s.find('.masterSifPoljeUSectionTabelaBody[data-id="'+o.attr("data-id")+'"]'),c=h.data("data-podatak"),n,u,f,r,e;if(c!=i&&(n=c.Podredjeni,n!=i&&n.length>0)){for(u="<tr>",f="",r=0;r<n.length;++r){var y=n[r],l=s.find('.masterSifPoljeUSection.podredjeni[data-id="'+y.Id+'"]'),a=l.find("#"+l.attr("data-fullId")),p=a.quiComboBox("getSelectedItemLabel"),v=a.quiComboBox("getSelectedItemData");u+='<td class="qTabelaTd">'+nonull(p)+"<\/td>";f+=r==0?nonull(v):"-"+nonull(v)}u+='<td class="qTabelaTd tac"><i class="fa fa-times"><\/i><\/td>                                                <\tr>';e=t(u);e.attr("data-id",f);h.append(e)}})}for(u+='<table class="qTabela qTabelaMala" style="margin-bottom:3px;">                            <thead>                                <tr>',h=n.Heder,a=0;a<h.length;++a)g=h[a],u+='<td class="qTabelaHeadTd" style="width: '+nonull(g.Sirina)+'">'+g.Naziv+"<\/td>";for(u+='<td class="qTabelaHeadTd" style="width: 30px"><\/td>',u+="<\/tr>                            <\/thead>                            <tbody id="+f+"TBodyFilter >                                <tr>",b=0;b<h.length;++b)u+='<td class="qTabelaTd" data-quitablefilter-type="txt"><\/td>';u+='<td class="qTabelaTd"><\/td>';u+='<\/tr>                            <\/tbody>                            <tbody class="masterSifPoljeUSectionTabelaBody" id="'+f+'" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <\/tbody>                        <\/table>';p.append(u);break;case 73:for(ri='<div>                            <div class="unosRedLbl_taL" style="overflow: hidden; max-height: 17px; '+gt+"; "+s+e+'">'+qKonverzija.VratiLokalizovaniTekst("Označi sve")+':<\/div>                            <div class="unosRedVr" style="float: right;">                                <input id="cekiranjeTabeleCheckBox" type="checkbox" style="'+e+' margin-right: 24px;"><\/div>                            <\/div>                        <\/div>',c.append(ri),u+='<table class="qTabela qTabelaMala" style="margin-bottom:3px;">                            <thead>                                <tr>                                    <td class="qTabelaHeadTd" style="width:50px;">'+qKonverzija.VratiLokalizovaniTekst("Izabran")+"<\/td>",h=n.Heder,a=0;a<h.length;++a)g=h[a],u+=' <td class="qTabelaHeadTd" style="width: '+nonull(g.Sirina)+'">'+g.Naziv+"<\/td>";for(u+="<\/tr>                            <\/thead>                            <tbody id="+f+'TBodyFilter >                                <tr>                                    <td class="qTabelaTd"><\/td>',b=0;b<h.length;++b){ui=h[b];switch(ui.TipPodatka){case 3:u+=' <td class="qTabelaTd" data-quitablefilter-type="dec"><\/td>';break;default:u+=' <td class="qTabelaTd" data-quitablefilter-type="txt"><\/td>'}}u+='<\/tr>                            <\/tbody>                            <tbody class="masterSifPoljeUSectionTabelaBody" id="'+f+'" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <\/tbody>                        <\/table>';p.append(u);break;case 1e3:u+='<div class="masterSifPoljeUSection unosRed" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <div class="teloDugmeWrapUFormi btnW3" id="'+f+'BtnUploadSlike" style="margin-bottom: 5px; float: left;"><\/div>                            <div style="padding-top: 5px; float: left; margin-left: 80px;">(1200 x 100)<\/div>                            <div class="unosRedVr" style="'+e+' float: right; max-height: 150px;" id="'+f+'" data-urlSlike="'+o+'">                                <img style="max-width: 100%; max-height: 100%;" src="'+o+'"/>                            <\/div>                            <div class="clear"><\/div>                        <\/div>                        <div class="clear"><\/div>';p.append(u);break;case 2e3:u+='<div class="masterSifPoljeUSection" data-tip="'+n.TipPodatka+'" data-id="'+n.Id+'" data-fullId="'+f+'">                            <div class="unosRedVr" style="width: 100%;">                                <textarea class="myInputTAFix" style="width:100%; max-height: calc(100vh - 300px); min-height: calc(100vh - 400px);" value="'+o+'" data-val="'+o+'" id="'+f+'">'+o+'<\/textarea>                            <\/div>                        <\/div><div class="clear"><\/div>';p.append(u)}switch(n.TipPodatka){case 2:fi=t("#"+f);yt(fi);break;case 20:nt=t("#"+f);ei=nt.width();nt.quiComboBox({listWidth:300,width:ei,showX:!0});nt.quiComboBox("setItemsFromBinding",n.IzborniPodaci,"Naziv","IdPodatka");o.length>0&&nt.quiComboBox("selectItemByDataNoTrigger",o);n.IdZavisnogElementa!=i&&vt(nt);break;case 21:dt=t("#"+f);oi=dt.width();dt.quiMultiselect({listWidth:300,width:oi}).quiMultiselect("setItems",n.IzborniPodaci,"Naziv","Izabran");break;case 70:v=t("#"+f);v.data("data-podatak",n);lt(v,n.IzborniPodaci,n.Heder);at(v);break;case 73:v=t("#"+f);wt(v,n.IzborniPodaci,n.Heder);bt(v);pt(ni,v);break;case 1e3:kt(f,f+"BtnUploadSlike",n.Naziv)}}}function ht(){var n=[];return t("#masterSifTabovi .tab").each(function(){var l=t(this).attr("data-tab"),a=t("#masterSifSectionWrap").find(l),s=a.find("#masterSifSectionContentPolja"),h=s.find(".masterSifPoljeUSection:not(.podredjeni)"),u,o,c;if(h.length>0&&h.each(function(){var i={},u=t(this),f=u.attr("data-tip"),r=u.attr("data-fullid"),e,o;i.TipPodatka=f;i.Id=u.attr("data-id");e=parseFloat(f);switch(e){case 0:i.Vrednost=t("#"+r).val().trimnull();break;case 2:i.Vrednost=t("#"+r).val().trimnull();break;case 11:i.Vrednost=t("#"+r).val().trimnull();break;case 111:i.Vrednost=t("#"+r).val().trimnull();break;case 112:i.Vrednost=t("#"+r).val().trimnull();break;case 13:i.Vrednost=t("#"+r).prop("checked");break;case 20:i.Vrednost=t("#"+r).quiComboBox("getSelectedItemData");break;case 21:o=t("#"+r).quiMultiselect("getSelectedItems",1);i.IzborniPodaci=o;break;case 2e3:i.Vrednost=t("#"+r).val().trimnull()}n.push(i)}),u=s.find(".qTabela"),u.length>0){var f={},e=[],r=u.find("tbody:eq(0)");r.attr("data-tip")==i&&(r=u.find("tbody:eq(1)"));f.Id=r.attr("data-id");o=r.attr("data-tip");f.TipPodatka=o;c=parseFloat(o);switch(c){case 70:r.find("tr").each(function(){var n=t(this),i={IdPodatka:n.attr("data-id")};e.push(i)});break;case 73:r.find("tr").each(function(){var n={},i=t(this);i.find("td").each(function(i){switch(i){case 0:n.Izabran=t(this).find("input").prop("checked");break;case 1:n.IdPodatka=t(this).attr("data-id");n.Naziv=t(this).text();break;case 2:n.Podatak1=t(this).text();break;case 3:n.Podatak1=t(this).text();break;case 4:n.Podatak1=t(this).text();break;case 5:n.Podatak1=t(this).text();break;case 6:n.Podatak1=t(this).text()}});e.push(n)})}f.IzborniPodaci=e;n.push(f)}}),n}function ct(n){var r=i,e;u!=i&&(r=u.IdElementa);e=n.parents(".masterSifPoljeUSection:eq(0)").attr("data-id");t.ajax({type:"GET",url:p,data:{tipDokumenta:f,idElementa:r,idElementaPodatka:e,kriterijum1:n.quiComboBox("getSelectedItemData")},success:function(n){var r,f,u,e,o;if(n.Greska){PrikaziProzor(!0,!0,getLang("W_PROZOR_NASLOV_GRESKA"),n.Poruka,"greska");return}if(r=n.Data,r!=i&&r.length>0)for(f=0;f<r.length;++f)u=r[f],e=t('.masterSifPoljeUSection:[data-id="'+u.Id+'"]'),e.length>0&&(o=e.find("#"+e.attr("data-fullId")),u.IzborniPodaci!=i&&u.IzborniPodaci.length>0?o.quiComboBox("setItemsFromBinding",u.IzborniPodaci,"Naziv","IdPodatka"):o.quiComboBox("clearItems"))},complete:function(){}})}function lt(n,r,u){var f="",o,e,s;if(r&&r.length>0)for(o=0;o<r.length;++o)e=r[o],f+='<tr data-id="'+e.IdPodatka+'">                            <td class="qTabelaTd">'+e.Naziv+"<\/td>",u!=i&&u.length>1&&(f+='<td class="qTabelaTd">'+nonull(e.Podatak1)+"<\/td>"),u!=i&&u.length>2&&(f+='<td class="qTabelaTd">'+nonull(e.Podatak2)+"<\/td>"),u!=i&&u.length>3&&(f+='<td class="qTabelaTd">'+nonull(e.Podatak3)+"<\/td>"),u!=i&&u.length>4&&(f+='<td class="qTabelaTd">'+nonull(e.Podatak4)+"<\/td>"),u!=i&&u.length>5&&(f+='<td class="qTabelaTd">'+nonull(e.Podatak5)+"<\/td>"),f+='<td class="qTabelaTd tac"><i class="fa fa-times"><\/i><\/td>',f+="<\/tr>";n.html(f);s=n.attr("data-fullId");t("#"+s+"TBodyFilter").quiTableFilter({tbodyId:"#"+s})}function at(n){n.on("click",".fa-times",function(){var n=t(this).parent().parent();n.remove()})}function vt(n){n.on("select",function(){var v=n.parent().parent().attr("data-idZavisnogElementa"),h=t('.masterSifPoljeUSection:[data-id="'+v+'"]'),r=t("#"+h.attr("data-fullId")),e,o,a,s;r.quiMultiselect("deselectAll");var p=h.attr("data-potrebniPodaci"),c=p.split("-"),l="";for(e=0;e<c.length;++e)o=t('.masterSifPoljeUSection:[data-id="'+c[e]+'"]'),o&&o.length>0&&(a=t("#"+o.attr("data-fullId")),l+=a.quiComboBox("getSelectedItemData")+"-");s=i;u!=i&&(s=u.IdElementa);t.ajax({type:"GET",url:y,data:{tipDokumenta:f,idElementa:s,kriterijum1:n.quiComboBox("getSelectedItemData"),kriterijum2:l},success:function(n){if(n.Greska){PrikaziProzor(!0,!0,getLang("W_PROZOR_NASLOV_GRESKA"),n.Poruka,"greska");return}var t=n.Data;t&&t.length>0?(r.quiMultiselect("setItems",t,"Naziv","Izabran"),r.quiMultiselect("deselectAll")):r.quiMultiselect("clearItems")},complete:function(){}})})}function yt(n){n.css("text-align","right");n.on("click",function(){n.select()});n.on("focus",function(){n.val(n.val()).css("text-align","left")});n.on("blur",function(){var i,t;if(n.css("text-align","right"),i=n.val().trim(),i===""){n.val(i);n.attr("data-val",i);return}if(t=parseInt(i),isNaN(t)||t<0){n.val(n.attr("data-val"));return}if(t==n.attr("data-val")){n.val(t);return}n.val(t);n.attr("data-val",t)});n.on("keypress",function(t){t.keyCode==13&&n.blur()})}function pt(n,i){n.find("#cekiranjeTabeleCheckBox").on("change",function(){t(this).prop("checked")?i.find("tr:visible").each(function(){t(this).find("input").prop("checked",!0)}):i.find("tr:visible").each(function(){t(this).find("input").prop("checked",!1)})})}function wt(n,r,u){var e="",o,f,s,h;if(r&&r.length>0){for(o=0;o<r.length;++o)f=r[o],s="",f.Izabran&&(s='checked="checked"'),e+='<tr >                            <td class="qTabelaTd tac">                                <input type="checkbox" '+s+'/>                            <\/td>                            <td class="qTabelaTd" data-id="'+f.IdPodatka+'">'+f.Naziv+"<\/td>",f.Podatak1!=i&&(e+=u[1]!=i&&u[1].DozvoljenUnos?'<td class="qTabelaTd qTabelaTdPromena" data-tipPodatka="'+u[1].TipPodatka+'">'+f.Podatak1+"<\/td>":'<td class="qTabelaTd">'+f.Podatak1+"<\/td>"),f.Podatak2!=i&&(e+=u[2]!=i&&u[2].DozvoljenUnos?'<td class="qTabelaTd qTabelaTdPromena" data-tipPodatka="'+u[2].TipPodatka+'">'+f.Podatak2+"<\/td>":'<td class="qTabelaTd">'+f.Podatak2+"<\/td>"),f.Podatak3!=i&&(e+=u[3]!=i&&u[3].DozvoljenUnos?'<td class="qTabelaTd qTabelaTdPromena" data-tipPodatka="'+u[3].TipPodatka+'">'+f.Podatak3+"<\/td>":'<td class="qTabelaTd">'+f.Podatak3+"<\/td>"),f.Podatak4!=i&&(e+=u[4]!=i&&u[4].DozvoljenUnos?'<td class="qTabelaTd qTabelaTdPromena" data-tipPodatka="'+u[4].TipPodatka+'">'+f.Podatak4+"<\/td>":'<td class="qTabelaTd">'+f.Podatak4+"<\/td>"),f.Podatak5!=i&&(e+=u[5]!=i&&u[5].DozvoljenUnos?'<td class="qTabelaTd qTabelaTdPromena" data-tipPodatka="'+u[5].TipPodatka+'">'+f.Podatak5+"<\/td>":'<td class="qTabelaTd">'+f.Podatak5+"<\/td>"),e+="<\/tr>";n.html(e);h=n.attr("data-fullId");t("#"+h+"TBodyFilter").quiTableFilter({tbodyId:"#"+h})}}function bt(n){n.on("click",".qTabelaTdPromena",function(){if(!t(this).hasClass("edit")){var n=t(this).text();t(this).html("<div><input type='text' class='myInput' value='"+n+"' style='width: 100%;' /><\/div>");t(this).find("input").focus();t(this).addClass("edit")}});n.on("blur",".qTabelaTdPromena input",function(){var i=t(this).val().trim(),n=t(this).parent().parent();n.empty().text(i);n.removeClass("edit")});n.on("keydown",".qTabelaTdPromena input",function(n){n.keyCode==13&&t(this).parent().parent().parent().find("input")[0].blur()})}function kt(i,r,u){t("#"+i).on("hover","img",function(){t("#"+i+"imageFullSize").toggle()});n.InitUploaderSlike(i,r,u)}function dt(n,i){PrikaziProzor(!1);var r=t("#"+i);r.attr("data-urlSlike",n);r.find("img").attr("src",n)}function gt(){var n='<div class="unosRed">',u,e,o,s;if(r.NazivKriterijuma1!=i&&(n+='<div class="unosRedLbl_taL" style="width: 90px;">'+r.NazivKriterijuma1+':<\/div>                        <div class="unosRedVr"><div id="kriterijum1"><\/div><\/div>'),r.NazivKriterijuma2!=i&&(n+='<div class="unosRedLbl_taL" style="width: 90px; margin-left: 10px;">'+r.NazivKriterijuma2+':<\/div>                    <div class="unosRedVr"><div id="kriterijum2"><\/div><\/div>'),r.NazivKriterijuma3!=i&&(n+='<div class="unosRedLbl_taL" style="width: 90px; margin-left: 10px;">'+r.NazivKriterijuma3+':<\/div>                    <div class="unosRedVr"><div id="kriterijum3"><\/div><\/div>'),n+="<\/div>",n!=='<div class="unosRed"><\/div>'){if(t("#masterSifStabloWrap").hide(),t("#masterSifKriterijumiWrap").html(n),u=230,r.NazivKriterijuma1!=i){e=t("#kriterijum1");e.quiComboBox({width:u,listWidth:350,showX:!1,zIndex:"3"});e.quiComboBox("setItemsFromBinding",r.PodaciKriterijuma1,"Naziv","IdPodatka");e.on("select",function(){t("#masterSifTree").hide();t("#masterSifStabloWrap").hide();t("#masterSifBtnWrap").hide();t("#masterSifTaboviIBtnWrap").hide();t("#masterSifTabovi").html("");t("#masterSifSectionWrap").html("");t("#kriterijum2").length>0&&r.ZavisniKriterijum2==!0&&t("#kriterijum2").quiComboBox("clearItems");t("#kriterijum3").length>0&&r.ZavisniKriterijum3==!0&&t("#kriterijum3").quiComboBox("clearItems");r.ZavisniKriterijum2&&t.ajax({type:"GET",url:l,data:{tipDokumenta:f,kriterijum1:t("#kriterijum1").quiComboBox("getSelectedItemData")},success:function(n){if(n.Greska){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),n.Poruka,"greska");return}t("#kriterijum2").quiComboBox("setItemsFromBinding",n.Data,"Naziv","IdPodatka")},complete:function(){}});t("#kriterijum2").length==0&&t("#masterSifBtnPretrazi").is(":visible")&&t("#masterSifBtnPretrazi").click()})}if(r.NazivKriterijuma2!=i){o=t("#kriterijum2");o.quiComboBox({width:u,listWidth:350,showX:!1,zIndex:"3"});o.quiComboBox("setItemsFromBinding",r.PodaciKriterijuma2,"Naziv","IdPodatka");o.on("select",function(){t("#masterSifStabloWrap").hide();t("#masterSifTree").hide();t("#masterSifBtnWrap").hide();t("#masterSifTaboviIBtnWrap").hide();t("#masterSifTabovi").html("");t("#masterSifSectionWrap").html("");t("#kriterijum3").length>0&&r.ZanisniKriterijum3==!0&&t("#kriterijum3").quiComboBox("clearItems");r.ZavisniKriterijum3&&t.ajax({type:"GET",url:a,data:{tipDokumenta:f,kriterijum1:t("#kriterijum1").quiComboBox("getSelectedItemData"),kriterijum2:t("#kriterijum2").quiComboBox("getSelectedItemData")},success:function(n){if(n.Greska){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),n.Poruka,"greska");return}t("#kriterijum3").quiComboBox("setItemsFromBinding",n.Data,"Naziv","IdPodatka")},complete:function(){}});t("#kriterijum3").length==0&&t("#masterSifBtnPretrazi").is(":visible")&&t("#masterSifBtnPretrazi").click()})}if(r.NazivKriterijuma3!=i){s=t("#kriterijum3");s.quiComboBox({width:u,listWidth:350,showX:!1,zIndex:"3"});s.quiComboBox("setItemsFromBinding",r.PodaciKriterijuma3,"Naziv","IdPodatka");s.on("select",function(){t("#masterSifStabloWrap").hide();t("#masterSifTree").hide();t("#masterSifBtnWrap").hide();t("#masterSifTaboviIBtnWrap").hide();t("#masterSifTabovi").html("");t("#masterSifSectionWrap").html("");t("#masterSifBtnPretrazi").is(":visible")&&t("#masterSifBtnPretrazi").click()})}r.PrikaziStablo?t("#masterSifBtnPretragaWrap").show():t("#masterSifBtnPretragaWrap").hide()}else t("#masterSifKriterijumiIPretragaWrap").hide()}function g(n){t("#masterSifTree").off("dblclick","span");t("#masterSifTree").off("click","span");t("#masterSifTree").off("click","i.node");t("#masterSifTree").quiTree({array:n,idProp:"IdElementa",idParentProp:"IdNadredjenogElementa",labelProp:"Naziv",rootValue:null,dblClickOpensNode:!0});t("#masterSifTree").find("li").css({"font-size":"14px","margin-bottom":"1px","margin-top":"1px"})}function nt(n){if(n){var i=t("#masterSifBtnObrisiNode").find("table"),u=t("#masterSifBtnDodajNoviNode").find("table"),f=t("#masterSifBtnIzmeniNode").find("table");r.DozvoljenoBrisanje?(i.hasClass("teloDugmeIskljuceno")&&i.removeClass("teloDugmeIskljuceno"),t("#masterSifBtnObrisiNode").show()):t("#masterSifBtnObrisiNode").hide();r.DozvoljenoDodavanje?(u.hasClass("teloDugmeIskljuceno")&&u.removeClass("teloDugmeIskljuceno"),t("#masterSifBtnDodajNoviNode").show()):t("#masterSifBtnDodajNoviNode").hide();r.DozvoljenaIzmena?(f.hasClass("teloDugmeIskljuceno")&&f.removeClass("teloDugmeIskljuceno"),t("#masterSifBtnIzmeniNode").show()):t("#masterSifBtnIzmeniNode").hide();t("#masterSifBtnWrap").show()}else t("#masterSifBtnWrap").hide()}function ni(){var n=t("#masterSifFilterStabla");n.on("keydown",function(r){if(r.keyCode==13){e=!0;var u=n.val().trim().toLowerCase();u=qKonverzija.KonvertujULatinicu(u);u==i||u.length==0?t("#masterSifTree ul").find("li").show():(u=tt(u),t("#masterSifTree ul").find("li").each(function(){var i=t(this),n=i.find("span").text().toLowerCase();n=qKonverzija.KonvertujULatinicu(n);n=tt(n);n.contains(u)?i.show():i.hide()}))}})}function tt(n){return n=n.replace(/ć/g,"c"),n=n.replace(/č/g,"c"),n=n.replace(/ž/g,"z"),n=n.replace(/ž/g,"z"),n=n.replace(/š/g,"s"),n.replace(/đ/g,"dj")}function ti(){if(r.PrikaziStablo){g(r.Elementi);var n=r.NazivKriterijuma1!=i||r.NazivKriterijuma2!=i||r.NazivKriterijuma3!=i?!1:!0;nt(n);r.PrikaziFilter?(ni(),t("#masterSifFilterStablaWrap").show()):t("#masterSifFilterStablaWrap").hide();t("#masterSifTree").show()}else t("#masterSifStabloWrap").html("")}var f,r,u,o,s,h,c,l,a,v,y,p,w=[],e=!0;n.InitUploaderSlike=function(n,i,r){var e={tipDokumenta:f},o=new qq.FineUploader({element:document.getElementById(i),multiple:!1,validation:{allowedExtensions:["jpg","jpeg","gif","bmp","png"],sizeLimit:5242880},request:{endpoint:v,inputName:"postedFileName"},text:{uploadButton:r},template:'<div class="qq-uploader"><div class="qq-upload-drop-area" style="display: none;"><span>{dragZoneText}<\/span><\/div><div class="qq-upload-button" style="position: relative; overflow: hidden; direction: ltr;"><div><span class="ubt">{uploadButtonText}<\/span><\/div><\/div><ul class="qq-upload-list" style="display:none"><\/ul><\/div>',callbacks:{onUpload:function(n,i){t("#file span").text(i)},onProgress:function(n,i,r,u){var f=r/u*100;t("#file b").text(f+"%")},onComplete:function(t,i,r){r.Greska?PrikaziProzor(!0,!1,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),r.poruka,"greska"):dt(r.url,n)},onSubmit:function(){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("OBAVEŠTENJE"),'Učitavanje slike<br><br><img src="'+_pathImg+'loadProgress2.gif" alt="" />',"ucitavanje");var t={tipDokumenta:f,idElementa:u.IdElementa},n=e;qq.extend(n,t);this.setParams(n)}},showMessage:function(n){PrikaziProzor(!0,!0,qKonverzija.VratiLokalizovaniTekst("GREŠKA"),n,"greska")}})};n.Init=function(){f=t("#tipDokumenta").text();r=qUtils.IzvuciVM();o=t("#url_VratiPodatkeElementa").text();s=t("#url_VratiPodatke").text();h=t("#url_SnimiPodatkeElementa").text();c=t("#url_ObrisiElement").text();l=t("#url_VratiPodatkeKriterijuma2").text();a=t("#url_VratiPodatkeKriterijuma3").text();v=t("#url_SnimiSlikuElementa").text();y=t("#url_VratiPodatkeZavisnogElementa").text();p=t("#url_VratiZavisnePodatkeElementa").text();log(r);t("#masterSifNaslov").text(r.Naziv);gt();ti();t("#masterSifBtnDodajNoviNode").on("click",function(){k(!0)});t("#masterSifBtnIzmeniNode").on("click",function(){k(!1)});t("#masterSifTree").on("select",function(n,f){var s,l;if(t("#masterSifTaboviIBtnWrap").hide(),t("#masterSifTabovi").html(""),t("#masterSifSectionWrap").html(""),e&&(t("#masterSifTree ul").find("li").show(),t("#masterSifFilterStabla").val(""),t("#masterSifTree").find(".sel").length>0&&(s=t("#masterSifTree").find(".sel"),s.offset().top>500&&(l=s.parent().prevAll().length*(s.height()+1),t("#masterSifTree").scrollTop(l))),e=!1),u!=i&&u.IdElementa==f.IdElementa){t("#masterSifTree").find(".sel").removeClass("sel");u=i;return}u=f;var o=t("#masterSifBtnDodajNoviNode").find("table"),h=t("#masterSifBtnIzmeniNode").find("table"),c=t("#masterSifBtnObrisiNode").find("table");r.DodavanjeIdeNaRoot?o.hasClass("teloDugmeIskljuceno")&&o.removeClass("teloDugmeIskljuceno"):u.DozvoljenoDodavanje?o.hasClass("teloDugmeIskljuceno")&&o.removeClass("teloDugmeIskljuceno"):o.hasClass("teloDugmeIskljuceno")||o.addClass("teloDugmeIskljuceno");u.DozvoljenaIzmena?h.hasClass("teloDugmeIskljuceno")&&h.removeClass("teloDugmeIskljuceno"):h.hasClass("teloDugmeIskljuceno")||h.addClass("teloDugmeIskljuceno");u.DozvoljenoBrisanje?c.hasClass("teloDugmeIskljuceno")&&c.removeClass("teloDugmeIskljuceno"):c.hasClass("teloDugmeIskljuceno")||c.addClass("teloDugmeIskljuceno")});t("#masterSifBtnSacuvaj").click(ot);t("#masterSifBtnObrisiNode").click(et);t("#masterSifBtnReset").click(ft);t("#masterSifBtnPretrazi").click(ut);t("#masterSifTabovi").on("click","li",it);r.PodaciKriterijuma1!=i&&r.PodaciKriterijuma1.length==1&&(t("#kriterijum1").quiComboBox("selectItemByIndex",0),t("#kriterijum1").quiComboBox("enable",!1))}})(window.qMasterSif=window.qMasterSif||{},jQuery);